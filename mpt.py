import banner, requests

class HackerTargetAPI():
    def __init__(self):
        self.methods = [
            'mtr',
            'nping',
            'dnslookup',
            'reversedns',
            'hostsearch',
            'findshareddns',
            'zonetransfer',
            'whois',
            'geoip',
            'reverseiplookup',
            'nmap',
            'subnetcalc',
            'httpheaders',
            'pagelinks'
        ]

    def req(self, opcion):
        try:
            i = input("[Target]: ")
            r = requests.get(f"https://api.hackertarget.com/{self.methods[int(opcion)]}/?q={i}")
            print(f"""
Resultados:
{r.text}""")
        except IndexError:
            print("No existe ese method")

if __name__ == '__main__':
    c = HackerTargetAPI()
    banner.banner()
    opcion = input(">> ")
    c.req(opcion)
